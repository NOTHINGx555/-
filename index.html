<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* (Your existing CSS here) */
    </style>
</head>
<body>

    <div class="frame-container">
        <div class="video-container" id="videoContainer">
            <input type="text" id="videoUrl" placeholder="..." oninput="verifyLink()">
            <span class="link-status" id="linkStatus"></span>
            <iframe id="videoPlayer" allowfullscreen></iframe>
        </div>
        
        <select id="linkList" onclick="loadSelectedLink()"></select>
        
        <button class="open-button" onclick="openPornhub()">V</button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", loadSavedLinks);

        function loadVideo(url) {
            const videoPlayer = document.getElementById("videoPlayer");
            const linkStatus = document.getElementById("linkStatus");

            if (url.includes("pornhub.com")) {
                const videoId = url.split("viewkey=")[1];
                if (videoId) {
                    videoPlayer.src = `https://www.pornhub.com/embed/${videoId}`;
                    videoPlayer.style.display = "block";
                    linkStatus.textContent = "Valid link.";
                    linkStatus.className = "link-status valid";
                    hideLinkStatusAfterDelay();
                    saveLink(url);
                } else {
                    videoPlayer.style.display = "none";
                    linkStatus.textContent = "Video ID not found.";
                    linkStatus.className = "link-status";
                    hideLinkStatusAfterDelay();
                }
            } else {
                videoPlayer.style.display = "none";
                linkStatus.textContent = "Invalid link. Ensure it's from Pornhub.";
                linkStatus.className = "link-status";
                hideLinkStatusAfterDelay();
            }
        }

        function verifyLink() {
            const url = document.getElementById("videoUrl").value;
            loadVideo(url);
        }

        function hideLinkStatusAfterDelay() {
            const linkStatus = document.getElementById("linkStatus");
            setTimeout(() => {
                linkStatus.textContent = "";
                linkStatus.className = "link-status";
            }, 500);
        }

        function openPornhub() {
            window.open("https://www.pornhub.com", "_blank");
        }

        // Extract title from the page (requires permission)
        async function getTitle(url) {
            // This would need server-side fetching or user grant for a full implementation.
            // A placeholder:
            return "Video Title Placeholder";
        }

        async function saveLink(url) {
            let savedLinks = JSON.parse(localStorage.getItem("savedLinks")) || [];

            const title = await getTitle(url); // This requires permission to fetch titles dynamically.
            if (!savedLinks.some(link => link.url === url)) {
                savedLinks.push({ url, title });
                localStorage.setItem("savedLinks", JSON.stringify(savedLinks));
                loadSavedLinks();
            }
        }

        function loadSavedLinks() {
            const linkList = document.getElementById("linkList");
            linkList.innerHTML = "<option value=''>Saved Links</option>";
            const savedLinks = JSON.parse(localStorage.getItem("savedLinks")) || [];

            savedLinks.forEach(link => {
                const option = document.createElement("option");
                option.value = link.url;
                option.textContent = link.title;
                linkList.appendChild(option);
            });
        }

        function loadSelectedLink() {
            const selectedLink = document.getElementById("linkList").value;
            if (selectedLink) loadVideo(selectedLink);
        }
    </script>
</body>
</html>